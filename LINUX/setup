
BASEDIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

# Configure RUNTIME environment

. $BASEDIR/replicator_setup

# Configure DEVELOPMENT environment

export TERM=vt100
export LIBSRC=$BASEDIR/../SRC/LIBRARY
export REPSRC=$BASEDIR/../SRC/REPLICATOR
export TOOLSRC=$BASEDIR/../SRC/TOOLS
export REPLICATOR_INCLUDE=$BASEDIR/../SRC/LIBRARY
export SYNEXPDIR=$BASEDIR/../PROTO
export SYNIMPDIR=$BASEDIR/../PROTO
export REPLICATOR_OBJ=$BASEDIR/../OBJ
export REPLICATOR_XDL=$BASEDIR/../XDL
export RPSMFIL=$BASEDIR/../RPS/rpsmain.ism
export RPSTFIL=$BASEDIR/../RPS/rpstext.ism

if [ ! -f $RPSMFIL ]; then
    dos2unix $BASEDIR/../RPS/REPLICATION.SCH
    dbr RPS:rpsutl -i $BASEDIR/../RPS/REPLICATION.SCH -ia -ir
fi

if [ ! -f $REPLICATOR_DATA/DEPARTMENT.ISM ]; then
    dos2unix $REPLICATOR_DATA/DEPARTMENT.SEQ
    dos2unix $REPLICATOR_XDL/DEPARTMENT.XDL
    fconvert -it $REPLICATOR_DATA/DEPARTMENT.SEQ -oi $REPLICATOR_DATA/DEPARTMENT.ISM -d $REPLICATOR_XDL/DEPARTMENT.XDL
fi

if [ ! -f $REPLICATOR_DATA/EMPLOYEE.ISM ]; then
    dos2unix $REPLICATOR_DATA/EMPLOYEE.SEQ
    dos2unix $REPLICATOR_XDL/EMPLOYEE.XDL
    fconvert -it $REPLICATOR_DATA/EMPLOYEE.SEQ -oi $REPLICATOR_DATA/EMPLOYEE.ISM -d $REPLICATOR_XDL/EMPLOYEE.XDL
fi

if [ ! -f $REPLICATOR_DATA/REPLICATION_DEFAULT.ISM ]; then
    dos2unix $REPLICATOR_XDL/REPLICATION.XDL
    cd $BASEDIR/../DAT
    dbr DBLDIR:bldism -k $REPLICATOR_XDL/REPLICATION.XDL
    cd $BASEDIR/../LINUX
fi

